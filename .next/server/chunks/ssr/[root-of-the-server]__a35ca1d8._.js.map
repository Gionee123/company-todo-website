{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/intel/Desktop/cursor%20Ai/Call%20optix%20or%20Dafolks/company_task/src/app/compontent/common/admin/AdminRouteGuard.jsx"],"sourcesContent":["import { useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nexport default function AdminRouteGuard({ children }) {\r\n  const router = useRouter();\r\n  useEffect(() => {\r\n    const adminData = Cookies.get(\"admin\");\r\n    console.log(\"AdminRouteGuard - adminData:\", adminData);\r\n\r\n    if (!adminData) {\r\n      console.log(\r\n        \"AdminRouteGuard - No admin data found, redirecting to login\"\r\n      );\r\n      router.replace(\"/admin-panel/login\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const admin = JSON.parse(adminData);\r\n      console.log(\"AdminRouteGuard - Parsed admin:\", admin);\r\n\r\n      if (!admin || !admin.role || admin.role !== \"admin\") {\r\n        console.log(\r\n          \"AdminRouteGuard - Invalid admin role, redirecting to login\"\r\n        );\r\n        router.replace(\"/admin-panel/login\");\r\n      } else {\r\n        console.log(\"AdminRouteGuard - Admin authenticated successfully\");\r\n      }\r\n    } catch (error) {\r\n      console.log(\"AdminRouteGuard - Error parsing admin data:\", error);\r\n      router.replace(\"/admin-panel/login\");\r\n    }\r\n  }, [router]);\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;AAEe,SAAS,gBAAgB,EAAE,QAAQ,EAAE;IAClD,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,YAAY,qJAAA,CAAA,UAAO,CAAC,GAAG,CAAC;QAC9B,QAAQ,GAAG,CAAC,gCAAgC;QAE5C,IAAI,CAAC,WAAW;YACd,QAAQ,GAAG,CACT;YAEF,OAAO,OAAO,CAAC;YACf;QACF;QAEA,IAAI;YACF,MAAM,QAAQ,KAAK,KAAK,CAAC;YACzB,QAAQ,GAAG,CAAC,mCAAmC;YAE/C,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,IAAI,MAAM,IAAI,KAAK,SAAS;gBACnD,QAAQ,GAAG,CACT;gBAEF,OAAO,OAAO,CAAC;YACjB,OAAO;gBACL,QAAQ,GAAG,CAAC;YACd;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,GAAG,CAAC,+CAA+C;YAC3D,OAAO,OAAO,CAAC;QACjB;IACF,GAAG;QAAC;KAAO;IACX,qBAAO;kBAAG;;AACZ","debugId":null}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/intel/Desktop/cursor%20Ai/Call%20optix%20or%20Dafolks/company_task/src/app/%28admin-group%29/admin-panel/dashboard/page.js"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from 'react';\r\nimport AdminRouteGuard from '@/app/compontent/common/admin/AdminRouteGuard';\r\nimport axios from 'axios';\r\nimport baseUrl from \"@/config/api\";\r\n\r\nexport default function Dashboard() {\r\n  // const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || \"http://localhost:5000\";\r\n  const [stats, setStats] = useState({\r\n    totalUsers: 0,\r\n    pendingUsers: 0,\r\n    totalTodos: 0,\r\n    completionPercent: 0\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n  const [notification, setNotification] = useState(null);\r\n  const [recentActivities, setRecentActivities] = useState([]);\r\n  const [lastUpdated, setLastUpdated] = useState(null);\r\n\r\n  // Fetch dashboard data from API\r\n  const fetchDashboardData = async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      // Fetch pending users\r\n      const pendingUsersResponse = await axios.get(`${baseUrl}/api/backend/users/pending-users`);\r\n      const pendingUsers = pendingUsersResponse.data || [];\r\n\r\n      // Fetch all users (approved, rejected, pending)\r\n      const allUsersResponse = await axios.get(`${baseUrl}/api/backend/users/all-actions`);\r\n      const allUsers = allUsersResponse.data || [];\r\n\r\n      // Get todos from localStorage (since there's no todos API endpoint)\r\n      const todos = JSON.parse(localStorage.getItem('Todolist') || '[]');\r\n\r\n      // Calculate stats\r\n      const totalUsers = allUsers.length;\r\n      const pendingUsersCount = pendingUsers.length;\r\n      const totalTodos = todos.length;\r\n      const completedTodos = todos.filter(todo => todo.isStatus).length;\r\n      const completionPercent = totalTodos > 0 ? Math.round((completedTodos / totalTodos) * 100) : 0;\r\n\r\n      setStats({\r\n        totalUsers,\r\n        pendingUsers: pendingUsersCount,\r\n        totalTodos,\r\n        completionPercent\r\n      });\r\n\r\n      // Generate recent activities\r\n      const activities = [];\r\n\r\n      // Add recent user registrations\r\n      const recentUsers = allUsers.slice(0, 3);\r\n      recentUsers.forEach(user => {\r\n        activities.push({\r\n          type: 'user_registration',\r\n          message: `New user registered: ${user.name}`,\r\n          time: new Date(user.createdAt || Date.now()).toLocaleString(),\r\n          status: user.status\r\n        });\r\n      });\r\n\r\n      // Add recent todo completions\r\n      const recentTodos = todos.filter(todo => todo.isStatus).slice(0, 3);\r\n      recentTodos.forEach(todo => {\r\n        activities.push({\r\n          type: 'todo_completed',\r\n          message: `Todo completed: ${todo.Todolist}`,\r\n          time: new Date().toLocaleString(),\r\n          status: 'completed'\r\n        });\r\n      });\r\n\r\n      setRecentActivities(activities.slice(0, 5));\r\n      setLastUpdated(new Date().toLocaleString());\r\n\r\n      console.log('✅ Dashboard data loaded:', {\r\n        totalUsers,\r\n        pendingUsers: pendingUsersCount,\r\n        totalTodos,\r\n        completionPercent\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('❌ Error fetching dashboard data:', error);\r\n\r\n      // Fallback to localStorage data if API fails\r\n      const todos = JSON.parse(localStorage.getItem('Todolist') || '[]');\r\n      const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');\r\n\r\n      const totalUsers = users.length;\r\n      const pendingUsers = users.filter(u => u.status === 'pending').length;\r\n      const totalTodos = todos.length;\r\n      const completedTodos = todos.filter(t => t.isStatus).length;\r\n      const completionPercent = totalTodos > 0 ? Math.round((completedTodos / totalTodos) * 100) : 0;\r\n\r\n      setStats({ totalUsers, pendingUsers, totalTodos, completionPercent });\r\n      setLastUpdated(new Date().toLocaleString());\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDashboardData();\r\n  }, [baseUrl]);\r\n\r\n  useEffect(() => {\r\n    const handleStorage = (e) => {\r\n      if (e.key === 'admin_notification') {\r\n        const data = JSON.parse(e.newValue);\r\n        if (data && data.type === 'todo_completed') {\r\n          setNotification(`User completed a todo: ${data.todo.Todolist || data.todo.title}`);\r\n          setTimeout(() => setNotification(null), 5000);\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener('storage', handleStorage);\r\n    return () => window.removeEventListener('storage', handleStorage);\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <AdminRouteGuard>\r\n        <div className=\"min-h-screen bg-gray-50 p-6 flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n            <p className=\"text-gray-600\">Loading dashboard data...</p>\r\n          </div>\r\n        </div>\r\n      </AdminRouteGuard>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <AdminRouteGuard>\r\n      <div className=\"min-h-screen bg-gray-50 p-6\">\r\n        {notification && (\r\n          <div className=\"mb-4 p-4 bg-green-100 text-green-800 rounded shadow\">\r\n            {notification}\r\n          </div>\r\n        )}\r\n\r\n        {/* Header with refresh button */}\r\n        <div className=\"flex justify-between items-center mb-6\">\r\n          <h1 className=\"text-3xl font-bold text-gray-800\">Admin Dashboard</h1>\r\n          <div className=\"flex items-center gap-4\">\r\n            {lastUpdated && (\r\n              <span className=\"text-sm text-gray-500\">\r\n                Last updated: {lastUpdated}\r\n              </span>\r\n            )}\r\n            <button\r\n              onClick={fetchDashboardData}\r\n              disabled={loading}\r\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors disabled:opacity-50\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\r\n              </svg>\r\n              {loading ? 'Refreshing...' : 'Refresh'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Stats Cards */}\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\r\n          <div className=\"bg-white rounded-lg shadow p-5 flex flex-col items-center\">\r\n            <span className=\"text-2xl font-semibold text-blue-600\">{stats.totalUsers}</span>\r\n            <span className=\"text-gray-500\">Total Users</span>\r\n          </div>\r\n          <div className=\"bg-white rounded-lg shadow p-5 flex flex-col items-center\">\r\n            <span className=\"text-2xl font-semibold text-yellow-600\">{stats.pendingUsers}</span>\r\n            <span className=\"text-gray-500\">Pending Users</span>\r\n          </div>\r\n          <div className=\"bg-white rounded-lg shadow p-5 flex flex-col items-center\">\r\n            <span className=\"text-2xl font-semibold text-green-600\">{stats.totalTodos}</span>\r\n            <span className=\"text-gray-500\">Total Todos</span>\r\n          </div>\r\n          <div className=\"bg-white rounded-lg shadow p-5 flex flex-col items-center\">\r\n            <span className=\"text-2xl font-semibold text-purple-600\">{stats.completionPercent}%</span>\r\n            <span className=\"text-gray-500\">Completion %</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Recent Activities */}\r\n        <div className=\"bg-white rounded-lg shadow p-6\">\r\n          <h2 className=\"text-xl font-semibold text-gray-800 mb-4\">Recent Activities</h2>\r\n          {recentActivities.length > 0 ? (\r\n            <div className=\"space-y-3\">\r\n              {recentActivities.map((activity, index) => (\r\n                <div key={index} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className={`w-2 h-2 rounded-full ${activity.status === 'approved' ? 'bg-green-500' :\r\n                      activity.status === 'pending' ? 'bg-yellow-500' :\r\n                        activity.status === 'rejected' ? 'bg-red-500' :\r\n                          'bg-blue-500'\r\n                      }`}></div>\r\n                    <span className=\"text-gray-700\">{activity.message}</span>\r\n                  </div>\r\n                  <span className=\"text-sm text-gray-500\">{activity.time}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-8 text-gray-500\">\r\n              <p>No recent activities</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </AdminRouteGuard>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AAJA;;;;;;AAMe,SAAS;IACtB,+EAA+E;IAC/E,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;QACjC,YAAY;QACZ,cAAc;QACd,YAAY;QACZ,mBAAmB;IACrB;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IAC3D,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAE/C,gCAAgC;IAChC,MAAM,qBAAqB;QACzB,IAAI;YACF,WAAW;YAEX,sBAAsB;YACtB,MAAM,uBAAuB,MAAM,qIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,GAAG,oHAAA,CAAA,UAAO,CAAC,gCAAgC,CAAC;YACzF,MAAM,eAAe,qBAAqB,IAAI,IAAI,EAAE;YAEpD,gDAAgD;YAChD,MAAM,mBAAmB,MAAM,qIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,GAAG,oHAAA,CAAA,UAAO,CAAC,8BAA8B,CAAC;YACnF,MAAM,WAAW,iBAAiB,IAAI,IAAI,EAAE;YAE5C,oEAAoE;YACpE,MAAM,QAAQ,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,eAAe;YAE7D,kBAAkB;YAClB,MAAM,aAAa,SAAS,MAAM;YAClC,MAAM,oBAAoB,aAAa,MAAM;YAC7C,MAAM,aAAa,MAAM,MAAM;YAC/B,MAAM,iBAAiB,MAAM,MAAM,CAAC,CAAA,OAAQ,KAAK,QAAQ,EAAE,MAAM;YACjE,MAAM,oBAAoB,aAAa,IAAI,KAAK,KAAK,CAAC,AAAC,iBAAiB,aAAc,OAAO;YAE7F,SAAS;gBACP;gBACA,cAAc;gBACd;gBACA;YACF;YAEA,6BAA6B;YAC7B,MAAM,aAAa,EAAE;YAErB,gCAAgC;YAChC,MAAM,cAAc,SAAS,KAAK,CAAC,GAAG;YACtC,YAAY,OAAO,CAAC,CAAA;gBAClB,WAAW,IAAI,CAAC;oBACd,MAAM;oBACN,SAAS,CAAC,qBAAqB,EAAE,KAAK,IAAI,EAAE;oBAC5C,MAAM,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,GAAG,IAAI,cAAc;oBAC3D,QAAQ,KAAK,MAAM;gBACrB;YACF;YAEA,8BAA8B;YAC9B,MAAM,cAAc,MAAM,MAAM,CAAC,CAAA,OAAQ,KAAK,QAAQ,EAAE,KAAK,CAAC,GAAG;YACjE,YAAY,OAAO,CAAC,CAAA;gBAClB,WAAW,IAAI,CAAC;oBACd,MAAM;oBACN,SAAS,CAAC,gBAAgB,EAAE,KAAK,QAAQ,EAAE;oBAC3C,MAAM,IAAI,OAAO,cAAc;oBAC/B,QAAQ;gBACV;YACF;YAEA,oBAAoB,WAAW,KAAK,CAAC,GAAG;YACxC,eAAe,IAAI,OAAO,cAAc;YAExC,QAAQ,GAAG,CAAC,4BAA4B;gBACtC;gBACA,cAAc;gBACd;gBACA;YACF;QAEF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,oCAAoC;YAElD,6CAA6C;YAC7C,MAAM,QAAQ,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,eAAe;YAC7D,MAAM,QAAQ,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,sBAAsB;YAEpE,MAAM,aAAa,MAAM,MAAM;YAC/B,MAAM,eAAe,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,WAAW,MAAM;YACrE,MAAM,aAAa,MAAM,MAAM;YAC/B,MAAM,iBAAiB,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,EAAE,MAAM;YAC3D,MAAM,oBAAoB,aAAa,IAAI,KAAK,KAAK,CAAC,AAAC,iBAAiB,aAAc,OAAO;YAE7F,SAAS;gBAAE;gBAAY;gBAAc;gBAAY;YAAkB;YACnE,eAAe,IAAI,OAAO,cAAc;QAC1C,SAAU;YACR,WAAW;QACb;IACF;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR;IACF,GAAG;QAAC,oHAAA,CAAA,UAAO;KAAC;IAEZ,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,gBAAgB,CAAC;YACrB,IAAI,EAAE,GAAG,KAAK,sBAAsB;gBAClC,MAAM,OAAO,KAAK,KAAK,CAAC,EAAE,QAAQ;gBAClC,IAAI,QAAQ,KAAK,IAAI,KAAK,kBAAkB;oBAC1C,gBAAgB,CAAC,uBAAuB,EAAE,KAAK,IAAI,CAAC,QAAQ,IAAI,KAAK,IAAI,CAAC,KAAK,EAAE;oBACjF,WAAW,IAAM,gBAAgB,OAAO;gBAC1C;YACF;QACF;QACA,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;IACrD,GAAG,EAAE;IAEL,IAAI,SAAS;QACX,qBACE,8OAAC,+JAAA,CAAA,UAAe;sBACd,cAAA,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;;;;;sCACf,8OAAC;4BAAE,WAAU;sCAAgB;;;;;;;;;;;;;;;;;;;;;;IAKvC;IAEA,qBACE,8OAAC,+JAAA,CAAA,UAAe;kBACd,cAAA,8OAAC;YAAI,WAAU;;gBACZ,8BACC,8OAAC;oBAAI,WAAU;8BACZ;;;;;;8BAKL,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAmC;;;;;;sCACjD,8OAAC;4BAAI,WAAU;;gCACZ,6BACC,8OAAC;oCAAK,WAAU;;wCAAwB;wCACvB;;;;;;;8CAGnB,8OAAC;oCACC,SAAS;oCACT,UAAU;oCACV,WAAU;;sDAEV,8OAAC;4CAAI,WAAU;4CAAU,MAAK;4CAAO,QAAO;4CAAe,SAAQ;sDACjE,cAAA,8OAAC;gDAAK,eAAc;gDAAQ,gBAAe;gDAAQ,aAAa;gDAAG,GAAE;;;;;;;;;;;wCAEtE,UAAU,kBAAkB;;;;;;;;;;;;;;;;;;;8BAMnC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAK,WAAU;8CAAwC,MAAM,UAAU;;;;;;8CACxE,8OAAC;oCAAK,WAAU;8CAAgB;;;;;;;;;;;;sCAElC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAK,WAAU;8CAA0C,MAAM,YAAY;;;;;;8CAC5E,8OAAC;oCAAK,WAAU;8CAAgB;;;;;;;;;;;;sCAElC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAK,WAAU;8CAAyC,MAAM,UAAU;;;;;;8CACzE,8OAAC;oCAAK,WAAU;8CAAgB;;;;;;;;;;;;sCAElC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAK,WAAU;;wCAA0C,MAAM,iBAAiB;wCAAC;;;;;;;8CAClF,8OAAC;oCAAK,WAAU;8CAAgB;;;;;;;;;;;;;;;;;;8BAKpC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAA2C;;;;;;wBACxD,iBAAiB,MAAM,GAAG,kBACzB,8OAAC;4BAAI,WAAU;sCACZ,iBAAiB,GAAG,CAAC,CAAC,UAAU,sBAC/B,8OAAC;oCAAgB,WAAU;;sDACzB,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAI,WAAW,CAAC,qBAAqB,EAAE,SAAS,MAAM,KAAK,aAAa,iBACvE,SAAS,MAAM,KAAK,YAAY,kBAC9B,SAAS,MAAM,KAAK,aAAa,eAC/B,eACF;;;;;;8DACJ,8OAAC;oDAAK,WAAU;8DAAiB,SAAS,OAAO;;;;;;;;;;;;sDAEnD,8OAAC;4CAAK,WAAU;sDAAyB,SAAS,IAAI;;;;;;;mCAT9C;;;;;;;;;iDAcd,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;0CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOjB","debugId":null}}]
}