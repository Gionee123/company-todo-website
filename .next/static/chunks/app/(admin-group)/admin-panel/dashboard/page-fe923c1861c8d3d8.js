(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{5695:(e,t,s)=>{"use strict";var n=s(8999);s.o(n,"usePathname")&&s.d(t,{usePathname:function(){return n.usePathname}}),s.o(n,"useRouter")&&s.d(t,{useRouter:function(){return n.useRouter}})},5963:(e,t,s)=>{Promise.resolve().then(s.bind(s,7557))},7383:(e,t,s)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)e[n]=s[n]}return e}s.d(t,{A:()=>a});var a=function e(t,s){function a(e,a,r){if("undefined"!=typeof document){"number"==typeof(r=n({},s,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var i in r)r[i]&&(o+="; "+i,!0!==r[i]&&(o+="="+r[i].split(";")[0]));return document.cookie=e+"="+t.write(a,e)+o}}return Object.create({set:a,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var s=document.cookie?document.cookie.split("; "):[],n={},a=0;a<s.length;a++){var r=s[a].split("="),o=r.slice(1).join("=");try{var i=decodeURIComponent(r[0]);if(n[i]=t.read(o,i),e===i)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){a(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(s)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},7557:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s(5155),a=s(2115),r=s(9016),o=s(3464);function i(){let e="https://company-todo-api.onrender.com",[t,s]=(0,a.useState)({totalUsers:0,pendingUsers:0,totalTodos:0,completionPercent:0}),[i,l]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)([]),[g,p]=(0,a.useState)(null),h=async()=>{try{l(!0);let t=(await o.A.get("".concat(e,"/api/backend/users/pending-users"))).data||[],n=(await o.A.get("".concat(e,"/api/backend/users/all-actions"))).data||[],a=JSON.parse(localStorage.getItem("Todolist")||"[]"),r=n.length,i=t.length,d=a.length,c=a.filter(e=>e.isStatus).length,u=d>0?Math.round(c/d*100):0;s({totalUsers:r,pendingUsers:i,totalTodos:d,completionPercent:u});let g=[];n.slice(0,3).forEach(e=>{g.push({type:"user_registration",message:"New user registered: ".concat(e.name),time:new Date(e.createdAt||Date.now()).toLocaleString(),status:e.status})}),a.filter(e=>e.isStatus).slice(0,3).forEach(e=>{g.push({type:"todo_completed",message:"Todo completed: ".concat(e.Todolist),time:new Date().toLocaleString(),status:"completed"})}),m(g.slice(0,5)),p(new Date().toLocaleString()),console.log("✅ Dashboard data loaded:",{totalUsers:r,pendingUsers:i,totalTodos:d,completionPercent:u})}catch(l){console.error("❌ Error fetching dashboard data:",l);let e=JSON.parse(localStorage.getItem("Todolist")||"[]"),t=JSON.parse(localStorage.getItem("registeredUsers")||"[]"),n=t.length,a=t.filter(e=>"pending"===e.status).length,r=e.length,o=e.filter(e=>e.isStatus).length,i=r>0?Math.round(o/r*100):0;s({totalUsers:n,pendingUsers:a,totalTodos:r,completionPercent:i}),p(new Date().toLocaleString())}finally{l(!1)}};return((0,a.useEffect)(()=>{h()},[e]),(0,a.useEffect)(()=>{let e=e=>{if("admin_notification"===e.key){let t=JSON.parse(e.newValue);t&&"todo_completed"===t.type&&(c("User completed a todo: ".concat(t.todo.Todolist||t.todo.title)),setTimeout(()=>c(null),5e3))}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),i)?(0,n.jsx)(r.A,{children:(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading dashboard data..."})]})})}):(0,n.jsx)(r.A,{children:(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50 p-6",children:[d&&(0,n.jsx)("div",{className:"mb-4 p-4 bg-green-100 text-green-800 rounded shadow",children:d}),(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Admin Dashboard"}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[g&&(0,n.jsxs)("span",{className:"text-sm text-gray-500",children:["Last updated: ",g]}),(0,n.jsxs)("button",{onClick:h,disabled:i,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors disabled:opacity-50",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),i?"Refreshing...":"Refresh"]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow p-5 flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-2xl font-semibold text-blue-600",children:t.totalUsers}),(0,n.jsx)("span",{className:"text-gray-500",children:"Total Users"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow p-5 flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-2xl font-semibold text-yellow-600",children:t.pendingUsers}),(0,n.jsx)("span",{className:"text-gray-500",children:"Pending Users"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow p-5 flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-2xl font-semibold text-green-600",children:t.totalTodos}),(0,n.jsx)("span",{className:"text-gray-500",children:"Total Todos"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow p-5 flex flex-col items-center",children:[(0,n.jsxs)("span",{className:"text-2xl font-semibold text-purple-600",children:[t.completionPercent,"%"]}),(0,n.jsx)("span",{className:"text-gray-500",children:"Completion %"})]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Recent Activities"}),u.length>0?(0,n.jsx)("div",{className:"space-y-3",children:u.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("approved"===e.status?"bg-green-500":"pending"===e.status?"bg-yellow-500":"rejected"===e.status?"bg-red-500":"bg-blue-500")}),(0,n.jsx)("span",{className:"text-gray-700",children:e.message})]}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:e.time})]},t))}):(0,n.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,n.jsx)("p",{children:"No recent activities"})})]})]})})}},9016:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(5155),a=s(2115),r=s(5695),o=s(7383);function i(e){let{children:t}=e,s=(0,r.useRouter)();return(0,a.useEffect)(()=>{let e=o.A.get("admin");if(console.log("AdminRouteGuard - adminData:",e),!e){console.log("AdminRouteGuard - No admin data found, redirecting to login"),s.replace("/admin-panel/login");return}try{let t=JSON.parse(e);console.log("AdminRouteGuard - Parsed admin:",t),t&&t.role&&"admin"===t.role?console.log("AdminRouteGuard - Admin authenticated successfully"):(console.log("AdminRouteGuard - Invalid admin role, redirecting to login"),s.replace("/admin-panel/login"))}catch(e){console.log("AdminRouteGuard - Error parsing admin data:",e),s.replace("/admin-panel/login")}},[s]),(0,n.jsx)(n.Fragment,{children:t})}}},e=>{e.O(0,[464,441,964,358],()=>e(e.s=5963)),_N_E=e.O()}]);